<div class="container py-4">
  <div class="row">
    <!-- Main content column - 9 columns -->
    <div class="col-md-9">
      <div class="container">
        <h2 class="fw-bold mb-4"><%= @listing.title %></h2>
        <!-- Carousel -->
        <div class="mb-4" id="listing-carousel">
          <div id="carouselExampleDark" class="carousel carousel-dark slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
              <% @listing.photos.each_with_index do |photo, index| %>
                <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="<%= index %>"
                  class="<%= 'active' if index == 0 %>" aria-current="<%= 'true' if index == 0 %>" aria-label="Slide <%= index + 1 %>"></button>
              <% end %>
            </div>
            <div class="carousel-inner">
              <% @listing.photos.each_with_index do |photo, index| %>
                <div class="carousel-item <%= 'active' if index == 0 %>">
                  <%= cl_image_tag photo.key, class: "d-block w-100" %>
                </div>
              <% end %>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
        </div>
        <!-- Description -->
        <div class="mb-4">
          <p><%= @listing.description %></p>
          <ul class="list-unstyled">
            <li><strong>Location:</strong> <%= @listing.address %></li>
            <li><strong>Posted by:</strong> <%= @listing.user.first_name %></li>
            <li><strong>Category:</strong> <%= @listing.category %></li>
            <li><strong>Price:</strong> <%= number_to_currency(@listing.price, unit: "â‚¬", format: "%n%u") %></li>
          </ul>
          <% if @listing.user == current_user %>
            <div class="mt-2">
              <%= link_to "Edit", edit_listing_path(@listing), class: "btn btn-secondary me-2" %>
              <%= link_to "Delete", listing_path(@listing), data: {turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this booking?"}, class: "btn btn-danger" %>
            </div>
          <% end %>
        </div>
        <!-- Map -->
        <div class="mb-4">
          <div style="width: 100%; height: 400px;"
            data-controller="map"
            data-map-markers-value="<%= @markers.to_json %>"
            data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
          </div>
        </div>
        <hr class="my-4">
      </div>
    </div>
    <!-- Booking form column - 3 columns with fixed position -->
    <div class="col-md-3">
      <div class="card bg-white rounded-4 shadow-lg border-0 p-4" style="position: sticky; top: 165px; box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);">
        <h5 class="card-title mb-3 text-dark"><strong>Make a booking</strong></h5>
        <%= render "shared/booking_form" %>
      </div>
    </div>
  </div>
</div>
